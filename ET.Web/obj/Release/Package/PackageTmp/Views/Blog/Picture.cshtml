@{
    Layout = null;
    Layout = "~/Views/Shared/_LayoutBlog.cshtml";
}
@section Title{
    易特网IT资讯平台
}
@section Header{

}
<style>
    .flow-box { border: 1px solid #ddd; width: 272px; margin-left: 0; margin-right: 24px; margin-bottom: 21px; padding-top: 0; padding-bottom: 0; margin-top: 10px; }
    .flow-box { float: left; display: inline; width: 266px; height: auto; margin-left: 5px; margin-bottom: 10px; padding-top: 11px; padding-bottom: 10px; border: 1px solid #dddddd; -moz-box-shadow: 0px 0px 2px #f4f4f4; -webkit-box-shadow: 0px 0px 2px #f4f4f4; box-shadow: 0px 0px 2px #f4f4f4; }

    .flow-thumb { width: 246px;margin:0 auto;max-height:300px; }
    .flow-thumb { text-align: center; padding-top: 12px; overflow: hidden; position: relative; }
    .flow-info2 { text-align: center; }
        .flow-info2 p { height: 44px; line-height: 44px; text-align: center; padding: 0 8px; overflow: hidden; font-size: 14px; color: #666; }
    .user-fav { left: 14px; top: 12px; }
    .user-dl, .user-fav, .user-rfav { z-index: 3; }
    .uploadN { background-color: #fafafa; border-top: 1px solid #f4f4f4; }
</style>
<div class="content-wrap">
    <div id="#container">
        <header class="archive-header"><h1><i class="fa fa-list"></i> &nbsp;分类：图库 </h1> </header>
        <div class="flow" id="listBox" style="">

            @foreach (ET.Sys_DEF.ShopGoodInfo item in ViewBag.ShopGoodInfo)
            {
                <div class="flow-box" style=" background-color: #fff;">
                    <div class="flow-thumb" style="height:; overflow:; position:relative;">
                        <a href="@PublicHelper.GetHostAddress()/blog/PictureDetail/@item.GoodID/" title="@item.GoodName" target="_blank" class="thumb-box">
                            <img src="@(@item.GoodPicture.Length > 0 ? @item.GoodPicture.Split(',')[0] : " /images/blog/nopicture.jpg")" title="@item.GoodName" alt="@item.GoodName">
                        </a>
                    </div>
                    <div class="flow-info2">
                        <p><a href="@PublicHelper.GetHostAddress()/blog/PictureDetail/@item.GoodID/" target="_blank" title="@item.GoodName">@item.GoodName</a></p>
                        <p class="uploadN" style="font-size:14px;">更新时间：@item.CreateTime.Value.ToString("yyyy-MM-dd")</p>
                    </div>
                </div>
            }
        </div>
        <div class="pagination-loading hidden" id="Loadding"><i class="fa fa-spinner fa-spin"></i> 数据载入中...</div>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
    });
    //异步加载数据 Start
    $.getData = function (opts) {
        $.ajax({
            url: opts.url,
            type: "get",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            data: { "groupNumber": opts.groupNumber },
            success: function (data, textStatus, xhr) {
                if (data.total && !isNaN(data.total))
                    totalGroups = Math.ceil(parseInt(data.total) / 10);
                if (data.rows && data.rows.length > 0) {

                    $.each(data.rows, function () {
                        $(".content").append('<div class="flow-box" style=" background-color: #fff;">                                   <div class="flow-thumb" style="height:; overflow:; position:relative;">                        <a href="@PublicHelper.GetHostAddress()/blog/PictureDetail/' + this.GoodID + '/" title="' + this.GoodName + '" target="_blank" class="thumb-box">                            <img src="' + (this.GoodPicture.toString().length > 0 ? this.GoodPicture.toString().split(',')[0] : " /Res/shop/index_files/NoPicture.jpg") + '" title="'+this.GoodName+'" alt="'+this.GoodName+'">                        </a>                    </div>                    <div class="flow-info2">                        <p><a href="@PublicHelper.GetHostAddress()/blog/PictureDetail/'+this.GoodID+'/" target="_blank" title="'+this.GoodName+'">'+this.GoodName+'</a></p>                        <p class="uploadN" style="font-size:14px;">更新时间：'+DateHelper.DateTimeFormatter(this.CreateTime, "yyyy-MM-dd")+'</p>                    </div>                </div>');
                    });
                }
                $('#Loadding').hide();
                opts.groupNumber++;
                opts.loading = false;

            },
            error: function (xmlHttpRequest, textStatus, errorThrown) {
                opts.loading = false;
                console.log(errorThrown.toString());
            }
        });
    }
    var totalGroups = 2;
    var trackLoad = {};
    trackLoad.groupNumber = 2;
    trackLoad.url = "@PublicHelper.GetHostAddress()/blog/ajaxgetgoodlist";
    $(window).scroll(function () {
        if ($(window).scrollTop() + $(window).height() >= $(document).height() - 80) {
            if (trackLoad.groupNumber <= totalGroups && !trackLoad.loading) {
                if (!trackLoad.loading) {
                    trackLoad.loading = true;
                    $('#Loadding').show().css("display", "block");
                    $.getData(trackLoad);
                }
            }
        }
    });
    //异步加载数据 End
</script>